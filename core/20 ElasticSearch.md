Elastic Search

#### 1	Elasticsearch快速入门系列

什么是Elasticsearch
Elasticsearch (ES)是一个基于Lucene构建的开源、分布式、RESTful 接口全文搜索引擎。Elasticsearch 还是一个分布式文档数据库，其中每个字段均是被索引的数据且可被搜索，它能够扩展至数以百计的服务器存储以及处理PB级的数据。它可以在很短的时间内在储、搜索和分析大量的数据。它通常作为具有复杂搜索场景情况下的核心发动机。
Elasticsearch就是为高可用和可扩展而生的。可以通过购置性能更强的服务器来完成。

#### 2	Elasticsearch应用场景

大型分布式日志分析系统ELK  elasticsearch（存储日志）+logstash(收集日志)+kibana(展示数据)
大型电商商品搜索系统、网盘搜索引擎等。

#### 3	Elasticsearch优势

横向可扩展性:只需要增加台服务器，做一点儿配置，启动一下Elasticsearch就可以并入集群。
分片机制提供更好的分布性:同一个索引分成多个分片(sharding), 这点类似于HDFS的块机制;分而治之的方式可提升处理效率。
高可用:提供复制( replica) 机制，一个分片可以设置多个复制，使得某台服务器在宕机的情况下，集群仍旧可以照常运行，并会把服务器宕机丢失的数据信息复制恢复到其他可用节点上。
口使用简单:共需一条命令就可以下载文件，然后很快就能搭建一一个站内搜索引擎。

#### 4	9300与9200区别

9300端口： ES节点之间通讯使用
9200端口： ES节点 和 外部 通讯使用
9300是TCP协议端口号，ES集群之间通讯端口号
9200端口号，暴露ES RESTful接口端口号

#### 5	Elasticsearch倒排索引

倒排表以字或词为关键字进行索引，表中关键字所对应的记录表项记录了出现这个字或词的所有文档，一个表项就是一个字表段，它记录该文档的ID和字符在该文档中出现的位置情况。

#### 6	Term与Match区别

Term查询不会对字段进行分词查询，会采用精确匹配。
Match会根据该字段的分词器，进行分词查询。

#### 7	Elasticsearch索引分词器

默认分词器器不支持中文分词，需要我们指定相应的中文分析器ik.

#### 8	Elasticsearch高可用集群管理

ES集群中索引可能由多个分片构成，并且每个分片可以拥有多个副本。通过将一个单独的索引分为多个分片，我们可以处理不能在一个单一的服务器上面运行的大型索引，简单的说就是索引的大小过大，导致效率问题。不能运行的原因可能是内存也可能是存储。由于每个分片可以有多个副本，通过将副本分配到多个服务器，可以提高查询的负载能力。
主分片和副分片：解决容错性。索引文件 均摊。

#### 9	Es集群思想：

Es 核心存放索引文件，实现集群，可以将索引文件均摊到集群服务器上，减少单台服务器的存储压力。
分片：将数据（索引文件）拆分到多台节点服务器上存储。（将完整的索引文件拆分成多个分片，分开存储在多个节点服务器上。）
分片分为主分片和副分片，目的是为了解决容错性问题。
注意：主分片和相应的备份分片不可以存放在同一节点上。主分片拥有读写权限，备份分片只有读权限。
索引主分片数量一旦确定不允许修改，底层使用路由算法 hash(routing) % 主分片数量，routing 就是文档id。
分片思路：主分片 = 节点数量；主分片 + 备份分片 = 节点数量的平方。

#### 10	Elk日志收集系统ELK elasticsearch+logstash+kibana

传统项目日志文件分布在不同的服务器上，所以查询日志比较繁琐，可以将日志存储在mongdb redis es中。
获取本地文件 以json格式存储在es服务器。
通过kibana通过页面形式，展示日志信息。
Logstash 相当于一个搬运工，将日志信息 转换成json格式，存储到es.
 先搭建ES 在搭建stash



